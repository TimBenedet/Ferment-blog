---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const base = import.meta.env.BASE_URL;

const allRecettes = await getCollection('recettes');
const recettes = allRecettes.map(r => ({
  title: r.data.title,
  slug: r.slug,
  difficulty: r.data.difficulty,
  time: r.data.time,
  category: r.data.category,
  description: r.data.description,
}));

const difficultyColors: Record<string, string> = {
  'Facile': 'text-emerald-400',
  'Intermédiaire': 'text-amber-400',
  'Avancé': 'text-red-400',
};
---

<Layout title="Recettes" description="Recettes de fermentation : koji, miso, bière et zéro déchet.">
  <!-- Hero -->
  <section class="py-16 lg:py-24 bg-[--color-ferment-darker]">
    <div class="max-w-7xl mx-auto px-6">
      <h1 class="text-4xl md:text-5xl lg:text-6xl font-display font-bold tracking-wider text-[--color-ferment-cream] mb-4">
        RECETTES
      </h1>
      <p class="text-xl text-[--color-ferment-gray] max-w-2xl">
        Des fermentations simples aux projets de longue haleine.
        Chaque recette est testée, documentée, et pensée zéro déchet.
      </p>
    </div>
  </section>

  <!-- Recettes Grid -->
  <section class="py-16">
    <div class="max-w-7xl mx-auto px-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {recettes.map((recette) => (
          <a
            href={`${base}recettes/${recette.slug}/`}
            class="group p-6 lg:p-8 bg-[--color-ferment-darker] border border-white/5 hover:border-[--color-ferment-accent]/30 transition-all duration-500"
          >
            <div class="flex items-start justify-between gap-4 mb-4">
              <span class="px-3 py-1 text-xs font-display uppercase tracking-wider bg-white/5 text-[--color-ferment-gray]">
                {recette.category}
              </span>
              <div class="flex items-center gap-4 text-xs">
                <span class={difficultyColors[recette.difficulty]}>
                  {recette.difficulty}
                </span>
                <span class="text-[--color-ferment-gray]">
                  {recette.time}
                </span>
              </div>
            </div>

            <h3 class="text-xl lg:text-2xl font-display font-bold text-[--color-ferment-cream] group-hover:text-[--color-ferment-accent] transition-colors mb-3">
              {recette.title}
            </h3>

            <p class="text-[--color-ferment-gray] text-sm leading-relaxed mb-4">
              {recette.description}
            </p>

            <span class="inline-flex items-center gap-2 text-sm text-[--color-ferment-accent] font-display uppercase tracking-wider">
              Voir la recette
              <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </span>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Coming Soon -->
  <section class="py-16 bg-[--color-ferment-darker]">
    <div class="max-w-4xl mx-auto px-6 text-center">
      <h2 class="text-2xl font-display font-bold text-[--color-ferment-cream] mb-4">
        Plus de recettes à venir
      </h2>
      <p class="text-[--color-ferment-gray] mb-8">
        Ce blog est en constante évolution. Revenez régulièrement pour découvrir
        de nouvelles fermentations et techniques zéro déchet.
      </p>
      <a href={`${base}journal/`} class="inline-block px-6 py-3 border border-[--color-ferment-accent] text-[--color-ferment-accent] font-display text-sm uppercase tracking-widest hover:bg-[--color-ferment-accent] hover:text-[--color-ferment-dark] transition-colors">
        Lire le journal
      </a>
    </div>
  </section>
</Layout>
